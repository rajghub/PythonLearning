
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait  # available since 2.4.0
from selenium.webdriver.support import expected_conditions as EC
from selenium.common.exceptions import TimeoutException

# Data collection
delay = 5
uploadfilename = "D:\Learning\Python\PythonLearning\BOTOX_ONERegistrationQuickLookGuide.html"
sesName = "Test Session name"
sesTitle = "Test Session title"
sesType = "Email Template"
sesCountry = "India"
sesProduct = "azwork"



browser = webdriver.Chrome('D:\\chromedriver')
print("Browser opened")
# browser.maximize_window()
# LOGIN FUNCTION
def siteLogin(url, uname, pwd):
    browser.get(url)
    username = browser.find_element_by_id('j_username')
    username.send_keys(uname)
    password = browser.find_element_by_id('j_password')
    password.send_keys(pwd)
    password.send_keys(Keys.ENTER)


siteLogin('https://login.veevavault.com/auth/login',
          'girish@vv-agency.com', 'V@ult123')

print("Loged in")
# -------------

# UPLOAD SECTION

browser.get('https://vv-agency-indegene.veevavault.com/ui/#inbox/upload')

print("Entered upload page")

# WAIT
browser.implicitly_wait(delay)

def chooseFileFunc():
    
    try:
        chooseFile = browser.find_element_by_id('inboxFileChooserHTML5')
        chooseFile.send_keys(uploadfilename)
        # chooseFile.click()
        
        print("Successful")
    except Exception as axp:
        print("Click ok Again")
        # clickOkBtn()
        chooseFileFunc()


def clicknextBtn():
    try:
        nextBtn = browser.find_element_by_id('inboxUploadNext')
        nextBtn.click()
        # nextBtn.send_keys(Keys.ENTER )
        print("Able to find NEXT BUTTON")
        clicknextBtn()
        
    except Exception as axp:
        print("unable to find NEXT BUTTON")
        # clicknextBtn()        


def clicksaveBtn():
    try:
        saveBtn = browser.find_element_by_id('inboxUploadSave')
        saveBtn.click()
        print('Save clicked')
    except Exception as axpn:
        print("Unable to click save")
        clicknextBtn()

# uploadType = browser.find_element_by_id('uploadTypeSelect')
# uploadType.click()        
chooseFileFunc()


# Choose Document Type
docType = browser.find_element_by_xpath('//*[@id="inboxUploadPageContent"]/div[1]/div[2]/div[2]/div/div[1]/div/div[2]/input')
docType.clear()
docType.send_keys('Email Fragment')
docType.click()
docType1 = browser.find_element_by_xpath('//*[@id="veevaBasePage"]/ul')

for li in docType1.find_elements_by_tag_name('li'):
    print(li.text)
    if li.text == sesType:
        # WebDriverWait(browser, 10)
        li.click() 
        # WebDriverWait(browser, 10)
        break
# ---------------------------------------------------

# Click NEXT button
clicknextBtn()


browser.implicitly_wait(delay)

# Document name
eleName=browser.find_element_by_name('name')
eleName.clear()
eleName.send_keys(sesName)

# Document Title
eleTitle=browser.find_element_by_name('title')
eleTitle.send_keys(sesTitle)
browser.implicitly_wait(delay)

# productName = browser.find_element_by_xpath('//*[@id="di3Form"]/div[2]/div[1]/div/div[1]/div[9]/div/div[2]/div/div[1]/input')
# productName.clear()
# productName.send_keys('India')
# productName.click()
# Select Country
# eleCountry=browser.find_element_by_name('country_b')
# print('ATTRIBUTE: ',eleCountry.get_attribute)

# eleCountry.send_keys(sesCountry)
# eleCountry.click()

try:
    productName = browser.find_element_by_xpath('//*[@id="di3Form"]/div[2]/div[2]/div/div[1]/div/div/div[2]/div/div[1]/input')
    productName.clear()
    productName.send_keys(sesProduct)
    productName.click()
    products = browser.find_element_by_xpath('//*[@id="veevaBasePage"]/ul')
    linkText = browser.find_element_by_link_text(sesProduct).click()
    # for lks in products.find_elements_by_tag_name('li'):
    #     print(lks.text)
    #     linkText = browser.find_element_by_link_text(sesProduct).click()
    #     break
except Exception as sp:
    print("Element Not Found")